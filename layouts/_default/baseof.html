{{- define "baseof" -}}
<!DOCTYPE html>
<html lang="{{ .Lang }}" dir="{{ i18n "dir" }}">
  <head>
    {{- /* Mantenemos todo lo que PaperMod inyecta habitualmente */ -}}
    {{ partial "head.html" . }}
    {{- /* Aquí podrías añadir los <link> extra si los necesitas */ -}}
  </head>
  <body class="{{ .Site.Params.style }} list" id="top">
    {{- /* Contenedores vacíos para inyectar dinámicamente */ -}}
    <div id="common-head"></div>
    <div id="header-container"></div>

    <main class="main">
      {{ block "main" . }}{{ end }}
      {{- /* Paginación, entradas, etc. */ -}}
    </main>

    <div id="footer-container"></div>

    {{- /* Finalmente, tus scripts: PaperMod y el nuestro */ -}}
    {{ partial "footer.html" . }}

    <script>
      // Solo cuando el DOM está listo
      document.addEventListener("DOMContentLoaded", function() {
        // Lista de URLs a cargar
        const parts = [
          { sel: "#common-head", url: "/head.html" },
          { sel: "#header-container", url: "/header.html" },
          { sel: "#footer-container", url: "/footer.html" }
        ];
        parts.forEach(({ sel, url }) => {
          fetch(url)
            .then(res => {
              if (!res.ok) throw new Error("Network error");
              return res.text();
            })
            .then(html => {
              const el = document.querySelector(sel);
              if (el) el.innerHTML = html;
            })
            .catch(console.error);
        });
      });
    </script>
  </body>
</html>
{{- end -}}